Content-Type: text/html; charset=utf-8

<%
require 'cgi'
load 'common.rb'

$date = nil
$ths = nil

def init()
	cgi = CGI.new
	$date = cgi['date'].gsub(/[\D]/, '')
	pat = sprintf(Const::TH_FILES, date)
	$ths = Dir::glob(pat).sort!
end

init()
%>

<!DOCTYPE html>

<html>

<head>
<meta charset="utf-8"/>
<title>Pictures</title>
</head>

<body>
<h1>Pictures</h1>

% $ths.each do |th|
% datetime = th.match(Const::TH_PATTERN)[1]
% file = sprint(Const::PIC_FILE, $date, datetime)
<p>
	<a href="<%= file %>"><%= file %>
		<img src="<%= th %>" alt="<%= date %>"/><br>
		<%= file %>
	</a>
</p>
% end

<footer>
  <p>
    <a href="http://validator.w3.org/check?uri=referer">
      <img src="W3C_HTML5_certified.png" alt="HTML5 validate" width="80"/>
    </a>
  </p>
</footer>
</body>

</html>
